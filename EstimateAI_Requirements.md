# EstimateAI - 要件定義書

**作成日**: 2025-11-07
**作成者**: 関口佳祐
**バージョン**: 1.0 (MVP)

---

## 📋 プロジェクト概要

### 目的
フリーランスエンジニアとして自身で要件定義を行い業務をこなしていくうえで、実際に使える見積もり・WBS作成ツール

### ターゲットユーザー
- 自分専用（認証機能は不要）

### 解決する課題
1. **工数見積もりの難しさ** - 経験則に頼らず、客観的な見積もりを出したい
2. **WBS作成の手間** - タスク分解・整理の作業を自動化したい
3. **見積もり精度の低さ** - 過去の実績データを活用して精度を上げたい

---

## 🎯 MVP機能（最小viable product）

### 必須機能（v1.0で実装）
- ✅ 要件の自然言語入力
- ✅ AIによる工数予測
- ✅ WBS自動生成
- ✅ ガントチャート作成
- ✅ データ保存（使うほど精度向上）
- ✅ WBS完全編集機能（タスク名、工数、追加/削除、並べ替え）
- ✅ タスク詳細管理（担当者、優先度、進捗%、依存関係）
- ✅ 過去データを活用したAI学習

### 見送り機能（v2.0以降）
- ❌ CSV/JSONエクスポート
- ❌ 複数ユーザー対応
- ❌ 権限管理

---

## 🌊 ユーザーフロー

```
1. ツール起動
   ↓
2. ダッシュボード（過去のプロジェクト一覧）
   ↓
3. 「新規作成」ボタン
   ↓
4. プロジェクト名入力 + 要件を自然言語で入力
   例: 「ECサイトを作りたい。商品一覧、カート、決済機能が必要」
   ↓
5. 「見積もり生成」ボタン
   ↓
6. AI処理中...（Claude API）
   ↓
7. 結果表示（1ページに全部）
   - 総工数サマリー
   - WBS（階層構造、編集可能）
   - ガントチャート
   ↓
8. 手動で編集
   - タスク名変更
   - 工数調整
   - タスク追加/削除
   - ドラッグ&ドロップで並べ替え
   - 担当者設定
   - 優先度設定
   - 依存関係設定
   ↓
9. 「保存」ボタン
   ↓
10. ダッシュボードに戻る
```

---

## 🖼️ 画面設計

### 1. ダッシュボード（プロジェクト一覧）

**表示内容**（カード形式）
- プロジェクト名
- 作成日
- 総工数（例: 120時間）
- 期間（2025-01-10 〜 2025-02-15）
- ステータス（予定/進行中/完了）
- 「新規作成」ボタン

**レイアウト**
```
┌─────────────────────────────────────┐
│  EstimateAI                [新規作成] │
├─────────────────────────────────────┤
│ ┌─────────────────────────────────┐ │
│ │ ECサイト構築プロジェクト         │ │
│ │ 作成日: 2025-01-05              │ │
│ │ 総工数: 120時間                 │ │
│ │ 期間: 2025-01-10 〜 2025-02-15  │ │
│ │ ステータス: 進行中              │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 社内システムリプレース           │ │
│ │ ...                             │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

### 2. プロジェクト作成画面

**入力項目**
- プロジェクト名（必須）
- 要件テキスト（必須、自然言語）
- 「見積もり生成」ボタン

**レイアウト**
```
┌─────────────────────────────────────┐
│  新規プロジェクト作成                │
├─────────────────────────────────────┤
│ プロジェクト名:                      │
│ [_____________________________]     │
│                                     │
│ 要件を入力してください:              │
│ ┌─────────────────────────────────┐ │
│ │ ECサイトを作りたい。              │ │
│ │ 商品一覧、カート、決済機能が必要  │ │
│ │                                 │ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│              [見積もり生成]          │
└─────────────────────────────────────┘
```

### 3. 結果表示・編集画面

**セクション構成**（1ページにスクロール表示）

#### セクション1: サマリーカード
- 総工数（合計時間）
- 開始日
- 終了日
- ステータス変更ドロップダウン

#### セクション2: WBS（タスク一覧）
- 階層構造表示
- 各タスク項目:
  - タスク名（編集可能）
  - 見積もり工数（編集可能）
  - 担当者（編集可能）
  - 優先度（高/中/低、編集可能）
  - 進捗%（0-100、編集可能）
  - 依存関係（他タスクとの関連）
- ドラッグ&ドロップで並べ替え
- 「タスク追加」「削除」ボタン

#### セクション3: ガントチャート
- WBSと連動
- タイムライン表示
- 依存関係を矢印で表示

**レイアウト**
```
┌─────────────────────────────────────┐
│  ECサイト構築プロジェクト     [保存] │
├─────────────────────────────────────┤
│ 【サマリー】                         │
│ 総工数: 120時間                      │
│ 期間: 2025-01-10 〜 2025-02-15       │
│ ステータス: [進行中 ▼]              │
├─────────────────────────────────────┤
│ 【WBS】                     [+追加]  │
│ ├ 要件定義 (8h) [担当:自分] [高]    │
│ ├ 設計 (16h)                        │
│ │  ├ DB設計 (8h)                    │
│ │  └ API設計 (8h)                   │
│ ├ 実装 (80h)                        │
│ │  ├ 商品一覧 (24h) [進捗:50%]      │
│ │  ├ カート (24h) [依存:商品一覧]   │
│ │  └ 決済 (32h) [依存:カート]       │
│ └ テスト (16h)                      │
├─────────────────────────────────────┤
│ 【ガントチャート】                   │
│ ┌─────────────────────────────────┐ │
│ │ [要件定義]■■                    │ │
│ │ [設計]    ■■■■                │ │
│ │ [実装]        ■■■■■■■■■■│ │
│ │ [テスト]                  ■■■■│ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

---

## 🗄️ データベース設計

### テーブル構成

#### 1. projects（プロジェクト）

| カラム名     | 型            | 説明                          |
|-------------|---------------|-------------------------------|
| id          | UUID          | 主キー                        |
| name        | VARCHAR(255)  | プロジェクト名                |
| description | TEXT          | 要件テキスト（自然言語）       |
| total_hours | DECIMAL(10,2) | 総工数（時間）                |
| start_date  | DATE          | 開始日                        |
| end_date    | DATE          | 終了日                        |
| status      | ENUM          | 予定/進行中/完了              |
| created_at  | TIMESTAMP     | 作成日時                      |
| updated_at  | TIMESTAMP     | 更新日時                      |

#### 2. tasks（タスク）

| カラム名          | 型            | 説明                              |
|------------------|---------------|-----------------------------------|
| id               | UUID          | 主キー                            |
| project_id       | UUID          | 外部キー（projects.id）           |
| parent_task_id   | UUID          | 親タスクID（null=ルートタスク）    |
| name             | VARCHAR(500)  | タスク名                          |
| estimated_hours  | DECIMAL(10,2) | 見積もり工数（時間）              |
| assignee         | VARCHAR(100)  | 担当者                            |
| priority         | ENUM          | 高/中/低                          |
| progress         | INTEGER       | 進捗率（0-100）                   |
| order            | INTEGER       | 表示順序                          |
| created_at       | TIMESTAMP     | 作成日時                          |
| updated_at       | TIMESTAMP     | 更新日時                          |

#### 3. task_dependencies（タスク依存関係）

| カラム名           | 型        | 説明                          |
|-------------------|-----------|-------------------------------|
| id                | UUID      | 主キー                        |
| task_id           | UUID      | 外部キー（このタスク）         |
| depends_on_task_id| UUID      | 外部キー（依存先タスク）       |
| created_at        | TIMESTAMP | 作成日時                      |

### ER図

```
projects (1) ─────< (N) tasks
                          │
                          │ (1)
                          │
                          ├──< (N) task_dependencies
                          │
                          │ (1)
                          │
                          └──< (N) task_dependencies (depends_on)
```

---

## 🛠️ 技術スタック

### フロントエンド
- **Next.js 15** (App Router)
- **TypeScript**
- **Tailwind CSS**
- **react-gantt-chart** (ガントチャート表示)

### バックエンド
- **Next.js API Routes** (モノリシック構成)

### データベース
- **Supabase** (PostgreSQL)
- **Prisma** (ORM)

### AI
- **Claude API** (Anthropic)

### デプロイ
- **Vercel**

### 開発ツール
- **Git/GitHub**
- **VS Code**
- **Claude Code**

---

## 🔄 AI処理フロー

### 入力
```
ユーザー入力:
- プロジェクト名
- 要件テキスト（自然言語）
- 過去のプロジェクトデータ（学習用）
```

### Claude API プロンプト構成
```
システムプロンプト:
「あなたはプロジェクト見積もりの専門家です。
要件を分析し、タスク分解（WBS）と工数見積もりを行ってください。」

ユーザープロンプト:
「以下のプロジェクトの見積もりをお願いします。

プロジェクト名: {name}
要件: {description}

【過去の実績データ】
- プロジェクト1: 総工数120時間、タスク数15個
- プロジェクト2: 総工数80時間、タスク数10個
...

【出力形式】
JSON形式で出力してください:
{
  "total_hours": 120,
  "tasks": [
    {
      "name": "要件定義",
      "estimated_hours": 8,
      "priority": "高",
      "subtasks": [...]
    }
  ]
}
```

### 出力
```json
{
  "total_hours": 120,
  "start_date": "2025-01-10",
  "end_date": "2025-02-15",
  "tasks": [
    {
      "id": "task-1",
      "name": "要件定義",
      "estimated_hours": 8,
      "priority": "高",
      "assignee": "自分",
      "progress": 0,
      "subtasks": []
    },
    {
      "id": "task-2",
      "name": "設計",
      "estimated_hours": 16,
      "priority": "高",
      "assignee": "自分",
      "progress": 0,
      "subtasks": [
        {
          "id": "task-2-1",
          "name": "DB設計",
          "estimated_hours": 8,
          "priority": "中",
          "assignee": "自分",
          "progress": 0
        }
      ]
    }
  ]
}
```

---

## 📅 開発スケジュール

### Week 1（11/7-11/11）
- [x] 要件定義完了
- [ ] プロジェクトセットアップ
- [ ] Supabase環境構築
- [ ] データベース作成（Prisma）

### Week 2（11/12-11/18）
- [ ] ダッシュボード実装
- [ ] プロジェクト作成画面実装
- [ ] Claude API統合

### Week 3（11/19-11/25）
- [ ] WBS表示・編集機能
- [ ] ガントチャート実装
- [ ] データ保存機能

### Week 4（11/26-12/2）
- [ ] 依存関係機能
- [ ] AI学習機能（過去データ活用）
- [ ] バグ修正・調整
- [ ] MVP完成・デプロイ

---

## ⚠️ リスクと制約

### リスク
1. **ガントチャート実装の複雑さ** → react-gantt-chartで軽減
2. **Claude API の制約** → レート制限に注意
3. **依存関係の実装難易度** → MVP範囲を調整可能
4. **ドラッグ&ドロップの実装** → react-dnd等のライブラリ利用

### 制約
- 自分専用（複数ユーザー対応は不要）
- 認証機能は不要
- エクスポート機能は後回し
- 開発期間: 約1ヶ月

---

## 🎯 成功指標

### MVP完成の定義
- [x] 要件定義完了
- [ ] 要件を入力してWBSが自動生成される
- [ ] ガントチャートが表示される
- [ ] タスクを手動編集できる
- [ ] データが保存され、再度開ける
- [ ] 過去データを活用してAIの精度が向上する
- [ ] Vercelにデプロイされ、本番環境で動作する

### 実用性の評価
- 実際に自分のプロジェクトで3件以上使用
- 見積もり精度が経験則と比較して±20%以内
- WBS作成時間が手動の1/3以下

---

## 🔗 参考リンク

- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [Prisma Documentation](https://www.prisma.io/docs)
- [Claude API Reference](https://docs.anthropic.com)
- [react-gantt-chart](https://github.com/MaTeMaTuK/gantt-task-react)

---

**次のステップ**: プロジェクトセットアップ → データベース設計 → 開発開始
